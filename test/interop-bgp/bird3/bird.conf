# BIRD3 configuration for BGP+BFD interoperability testing.
#
# ASN 65003, peers with GoBGP (ASN 65001) at 172.21.0.10.
# BFD monitors the BGP neighbor via "bfd on" in the BGP protocol.
# Announces 10.30.0.0/24 to GoBGP.
#
# When BFD detects failure (gobfd at 172.21.0.10 stops responding),
# BIRD3 will fast-teardown the BGP session.

log stderr all;

router id 172.21.0.30;

protocol device {
}

# Static route for announcement to GoBGP.
protocol static {
  ipv4;
  route 10.30.0.0/24 blackhole;
}

# BFD protocol â€” monitors gobfd-bgp at 172.21.0.10.
protocol bfd {
  interface "*" {
    min rx interval 300 ms;
    min tx interval 300 ms;
    multiplier 3;
  };

  neighbor 172.21.0.10;
}

# BGP peering with GoBGP at 172.21.0.10 (ASN 65001).
# "bfd on" ties this BGP session to the BFD neighbor above.
protocol bgp gobgp {
  local 172.21.0.30 as 65003;
  neighbor 172.21.0.10 as 65001;
  bfd on;

  ipv4 {
    import all;
    export where net = 10.30.0.0/24;
  };
}
